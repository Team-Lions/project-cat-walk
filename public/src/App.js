import React from 'react';
import ReactDOM from 'react-dom';
import axios from 'axios';
import Overview from './Overview/Overview.jsx';
import Rating from './Ratings&Reviews/rating.jsx';
import token from '../../public/token.js'; // ^^^^^^ update to where your token is until we figure out how we're doing tokens

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      productList: [],
      selectedProductId: null,
      productInfo: {},
      reviewData: {},
      starRating: 0,
      productStyles: [],
      selectedStyleId: null
    };
  }

  getProductList() {
    //request to get all products
    //returns a promise
    return axios.get('https://app-hrsei-api.herokuapp.com/api/fec2/hratx/products', {
      headers: {
        'Authorization': token
      }
    });
  }

  getProductInfo(productId) {
    //request to get all product info for specified product
    //returns a promise
    return axios.get(`https://app-hrsei-api.herokuapp.com/api/fec2/hratx/products/${productId}`, {
      headers: {
        'Authorization': token
      },
      params: {
        product_id: productId
      }
    });
  }

  getReviewMetaData(productId) {
    //request to get review metadata on a specified product
    //returns a promise
    return axios.get(`https://app-hrsei-api.herokuapp.com/api/fec2/hratx/reviews/meta`, {
      headers: {
        'Authorization': token
      },
      params: {
        product_id: productId
      }
    });
  }

  getStyles(productId) {
    //request to get all the styles available on single/specified product
    //returns a promise
    return axios.get(`https://app-hrsei-api.herokuapp.com/api/fec2/hratx/products/${productId}/styles`, {
      headers: {
        'Authorization': token
      },
      params: {
        product_id: productId
      }
    });
  }

  changeProduct(productId, newState = {}) {
    newState.selectedProductId = productId;
    this.getProductInfo(productId).then(productInfo => {
      newState.productInfo = productInfo.data;
      return this.getReviewMetaData(newState.selectedProductId);
    }).then(reviewData => {
      newState.reviewData = reviewData.data;
      console.log('reviewData: ', newState.reviewData);
      console.log('ratings: ', newState.reviewData.ratings); //calculate average review

      var num = 0;
      var denom = 0;

      for (var k in newState.reviewData.ratings) {
        num += Number.parseInt(k);
        denom += Number.parseInt(newState.reviewData.ratings[k]);
      } //don't want to divide by 0 incase there are no reviews


      if (denom === 0) {
        denom = 1;
      }

      newState.starRating = num / denom;
      return this.getStyles(newState.selectedProductId);
    }).then(styleData => {
      newState.productStyles = styleData.data.results;
      newState.selectedStyleId = newState.productStyles[0];
      console.log('all data retrieved');
      console.log('New State: ', newState);
      this.setState(newState);
    }).catch(err => {
      console.log('Error retriving data: ', err);
    });
  }

  componentDidMount() {
    //what does it mean "selects the page of results to return" in Products API page/do we even need to worry about that?
    //bascially the same as changing the selected product, but has to retrieve product list at the outset
    var newState = {};
    this.getProductList().then(products => {
      newState.productList = products.data;
      this.changeProduct(newState.productList[0].id, newState);
    }).catch(err => {
      console.log('Error retriving product List: ', err);
    });
  }

  render() {
    return /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement(Overview, null), /*#__PURE__*/React.createElement(Rating, null));
  }

}

;
export default App;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2NsaWVudC9zcmMvQXBwLmpzeCJdLCJuYW1lcyI6WyJSZWFjdCIsIlJlYWN0RE9NIiwiYXhpb3MiLCJPdmVydmlldyIsIlJhdGluZyIsInRva2VuIiwiQXBwIiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInN0YXRlIiwicHJvZHVjdExpc3QiLCJzZWxlY3RlZFByb2R1Y3RJZCIsInByb2R1Y3RJbmZvIiwicmV2aWV3RGF0YSIsInN0YXJSYXRpbmciLCJwcm9kdWN0U3R5bGVzIiwic2VsZWN0ZWRTdHlsZUlkIiwiZ2V0UHJvZHVjdExpc3QiLCJnZXQiLCJoZWFkZXJzIiwiZ2V0UHJvZHVjdEluZm8iLCJwcm9kdWN0SWQiLCJwYXJhbXMiLCJwcm9kdWN0X2lkIiwiZ2V0UmV2aWV3TWV0YURhdGEiLCJnZXRTdHlsZXMiLCJjaGFuZ2VQcm9kdWN0IiwibmV3U3RhdGUiLCJ0aGVuIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJyYXRpbmdzIiwibnVtIiwiZGVub20iLCJrIiwiTnVtYmVyIiwicGFyc2VJbnQiLCJzdHlsZURhdGEiLCJyZXN1bHRzIiwic2V0U3RhdGUiLCJjYXRjaCIsImVyciIsImNvbXBvbmVudERpZE1vdW50IiwicHJvZHVjdHMiLCJpZCIsInJlbmRlciJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBT0EsS0FBUCxNQUFrQixPQUFsQjtBQUNBLE9BQU9DLFFBQVAsTUFBcUIsV0FBckI7QUFDQSxPQUFPQyxLQUFQLE1BQWtCLE9BQWxCO0FBQ0EsT0FBT0MsUUFBUCxNQUFxQix5QkFBckI7QUFDQSxPQUFPQyxNQUFQLE1BQW1CLDhCQUFuQjtBQUNBLE9BQU9DLEtBQVAsTUFBa0IsdUJBQWxCLEMsQ0FDQTs7QUFFQSxNQUFNQyxHQUFOLFNBQWtCTixLQUFLLENBQUNPLFNBQXhCLENBQWtDO0FBQ2hDQyxFQUFBQSxXQUFXLENBQUNDLEtBQUQsRUFBUTtBQUNqQixVQUFNQSxLQUFOO0FBQ0EsU0FBS0MsS0FBTCxHQUFhO0FBQ1hD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OENXLEdBQTlDO0FBQ0QsS0FQRDtBQVFEOztBQUVESSxFQUFBQSxNQUFNLEdBQUc7QUFDUCx3QkFDRSw4Q0FDRSxvQkFBQyxRQUFELE9BREYsZUFFRSxvQkFBQyxNQUFELE9BRkYsQ0FERjtBQU1EOztBQXpIK0I7O0FBMEhqQztBQUVELGVBQWV6QyxHQUFmIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcbmltcG9ydCBPdmVydmlldyBmcm9tICcuL092ZXJ2aWV3L092ZXJ2aWV3LmpzeCc7XG5pbXBvcnQgUmF0aW5nIGZyb20gJy4vUmF0aW5ncyZSZXZpZXdzL3JhdGluZy5qc3gnO1xuaW1wb3J0IHRva2VuIGZyb20gJy4uLy4uL3B1YmxpYy90b2tlbi5qcyc7XG4vLyBeXl5eXl4gdXBkYXRlIHRvIHdoZXJlIHlvdXIgdG9rZW4gaXMgdW50aWwgd2UgZmlndXJlIG91dCBob3cgd2UncmUgZG9pbmcgdG9rZW5zXG5cbmNsYXNzIEFwcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBwcm9kdWN0TGlzdDogW10sXG4gICAgICBzZWxlY3RlZFByb2R1Y3RJZDogbnVsbCxcbiAgICAgIHByb2R1Y3RJbmZvOiB7fSxcbiAgICAgIHJldmlld0RhdGE6IHt9LFxuICAgICAgc3RhclJhdGluZzogMCxcbiAgICAgIHByb2R1Y3RTdHlsZXM6IFtdLFxuICAgICAgc2VsZWN0ZWRTdHlsZUlkOiBudWxsXG4gICAgfVxuICB9XG5cbiAgZ2V0UHJvZHVjdExpc3QoKSB7XG4gICAgLy9yZXF1ZXN0IHRvIGdldCBhbGwgcHJvZHVjdHNcbiAgICAvL3JldHVybnMgYSBwcm9taXNlXG4gICAgcmV0dXJuIGF4aW9zLmdldCgnaHR0cHM6Ly9hcHAtaHJzZWktYXBpLmhlcm9rdWFwcC5jb20vYXBpL2ZlYzIvaHJhdHgvcHJvZHVjdHMnLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdBdXRob3JpemF0aW9uJzogdG9rZW5cbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICBnZXRQcm9kdWN0SW5mbyhwcm9kdWN0SWQpIHtcbiAgICAvL3JlcXVlc3QgdG8gZ2V0IGFsbCBwcm9kdWN0IGluZm8gZm9yIHNwZWNpZmllZCBwcm9kdWN0XG4gICAgLy9yZXR1cm5zIGEgcHJvbWlzZVxuICAgIHJldHVybiBheGlvcy5nZXQoYGh0dHBzOi8vYXBwLWhyc2VpLWFwaS5oZXJva3VhcHAuY29tL2FwaS9mZWMyL2hyYXR4L3Byb2R1Y3RzLyR7cHJvZHVjdElkfWAse1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQXV0aG9yaXphdGlvbic6IHRva2VuXG4gICAgICB9LFxuICAgICAgcGFyYW1zOiB7XG4gICAgICAgIHByb2R1Y3RfaWQ6IHByb2R1Y3RJZFxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZ2V0UmV2aWV3TWV0YURhdGEocHJvZHVjdElkKSB7XG4gICAgLy9yZXF1ZXN0IHRvIGdldCByZXZpZXcgbWV0YWRhdGEgb24gYSBzcGVjaWZpZWQgcHJvZHVjdFxuICAgIC8vcmV0dXJucyBhIHByb21pc2VcbiAgICByZXR1cm4gYXhpb3MuZ2V0KGBodHRwczovL2FwcC1ocnNlaS1hcGkuaGVyb2t1YXBwLmNvbS9hcGkvZmVjMi9ocmF0eC9yZXZpZXdzL21ldGFgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdBdXRob3JpemF0aW9uJzogdG9rZW5cbiAgICAgIH0sXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgcHJvZHVjdF9pZDogcHJvZHVjdElkXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBnZXRTdHlsZXMocHJvZHVjdElkKSB7XG4gICAgLy9yZXF1ZXN0IHRvIGdldCBhbGwgdGhlIHN0eWxlcyBhdmFpbGFibGUgb24gc2luZ2xlL3NwZWNpZmllZCBwcm9kdWN0XG4gICAgLy9yZXR1cm5zIGEgcHJvbWlzZVxuICAgIHJldHVybiBheGlvcy5nZXQoYGh0dHBzOi8vYXBwLWhyc2VpLWFwaS5oZXJva3VhcHAuY29tL2FwaS9mZWMyL2hyYXR4L3Byb2R1Y3RzLyR7cHJvZHVjdElkfS9zdHlsZXNgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdBdXRob3JpemF0aW9uJzogdG9rZW5cbiAgICAgIH0sXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgcHJvZHVjdF9pZDogcHJvZHVjdElkXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBjaGFuZ2VQcm9kdWN0KHByb2R1Y3RJZCwgbmV3U3RhdGUgPSB7fSkge1xuICAgIG5ld1N0YXRlLnNlbGVjdGVkUHJvZHVjdElkID0gcHJvZHVjdElkO1xuICAgIHRoaXMuZ2V0UHJvZHVjdEluZm8ocHJvZHVjdElkKVxuICAgIC50aGVuKChwcm9kdWN0SW5mbykgPT4ge1xuICAgICAgbmV3U3RhdGUucHJvZHVjdEluZm8gPSBwcm9kdWN0SW5mby5kYXRhO1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0UmV2aWV3TWV0YURhdGEobmV3U3RhdGUuc2VsZWN0ZWRQcm9kdWN0SWQpO1xuICAgIH0pXG4gICAgLnRoZW4oKHJldmlld0RhdGEpID0+IHtcbiAgICAgIG5ld1N0YXRlLnJldmlld0RhdGEgPSByZXZpZXdEYXRhLmRhdGE7XG4gICAgICBjb25zb2xlLmxvZygncmV2aWV3RGF0YTogJywgbmV3U3RhdGUucmV2aWV3RGF0YSk7XG4gICAgICBjb25zb2xlLmxvZygncmF0aW5nczogJywgbmV3U3RhdGUucmV2aWV3RGF0YS5yYXRpbmdzKTtcbiAgICAgIC8vY2FsY3VsYXRlIGF2ZXJhZ2UgcmV2aWV3XG4gICAgICB2YXIgbnVtID0gMDtcbiAgICAgIHZhciBkZW5vbSA9IDA7XG4gICAgICBmb3IgKHZhciBrIGluIG5ld1N0YXRlLnJldmlld0RhdGEucmF0aW5ncykge1xuICAgICAgICBudW0gKz0gTnVtYmVyLnBhcnNlSW50KGspO1xuICAgICAgICBkZW5vbSArPSBOdW1iZXIucGFyc2VJbnQobmV3U3RhdGUucmV2aWV3RGF0YS5yYXRpbmdzW2tdKTtcbiAgICAgIH1cbiAgICAgIC8vZG9uJ3Qgd2FudCB0byBkaXZpZGUgYnkgMCBpbmNhc2UgdGhlcmUgYXJlIG5vIHJldmlld3NcbiAgICAgIGlmIChkZW5vbSA9PT0gMCkge1xuICAgICAgICBkZW5vbSA9IDE7XG4gICAgICB9XG4gICAgICBuZXdTdGF0ZS5zdGFyUmF0aW5nID0gbnVtIC8gZGVub207XG4gICAgICByZXR1cm4gdGhpcy5nZXRTdHlsZXMobmV3U3RhdGUuc2VsZWN0ZWRQcm9kdWN0SWQpO1xuICAgIH0pXG4gICAgLnRoZW4oKHN0eWxlRGF0YSkgPT4ge1xuICAgICAgbmV3U3RhdGUucHJvZHVjdFN0eWxlcyA9IHN0eWxlRGF0YS5kYXRhLnJlc3VsdHM7XG4gICAgICBuZXdTdGF0ZS5zZWxlY3RlZFN0eWxlSWQgPSBuZXdTdGF0ZS5wcm9kdWN0U3R5bGVzWzBdO1xuICAgICAgY29uc29sZS5sb2coJ2FsbCBkYXRhIHJldHJpZXZlZCcpO1xuICAgICAgY29uc29sZS5sb2coJ05ldyBTdGF0ZTogJywgbmV3U3RhdGUpO1xuICAgICAgdGhpcy5zZXRTdGF0ZShuZXdTdGF0ZSk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHJldHJpdmluZyBkYXRhOiAnLCBlcnIpO1xuICAgIH0pXG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAvL3doYXQgZG9lcyBpdCBtZWFuIFwic2VsZWN0cyB0aGUgcGFnZSBvZiByZXN1bHRzIHRvIHJldHVyblwiIGluIFByb2R1Y3RzIEFQSSBwYWdlL2RvIHdlIGV2ZW4gbmVlZCB0byB3b3JyeSBhYm91dCB0aGF0P1xuICAgIC8vYmFzY2lhbGx5IHRoZSBzYW1lIGFzIGNoYW5naW5nIHRoZSBzZWxlY3RlZCBwcm9kdWN0LCBidXQgaGFzIHRvIHJldHJpZXZlIHByb2R1Y3QgbGlzdCBhdCB0aGUgb3V0c2V0XG4gICAgdmFyIG5ld1N0YXRlID0ge307XG4gICAgdGhpcy5nZXRQcm9kdWN0TGlzdCgpXG4gICAgLnRoZW4oKHByb2R1Y3RzKSA9PiB7XG4gICAgICBuZXdTdGF0ZS5wcm9kdWN0TGlzdCA9IHByb2R1Y3RzLmRhdGE7XG4gICAgICB0aGlzLmNoYW5nZVByb2R1Y3QobmV3U3RhdGUucHJvZHVjdExpc3RbMF0uaWQsIG5ld1N0YXRlKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnRXJyb3IgcmV0cml2aW5nIHByb2R1Y3QgTGlzdDogJywgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdj5cbiAgICAgICAgPE92ZXJ2aWV3IC8+XG4gICAgICAgIDxSYXRpbmcgLz5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IEFwcDsiXX0=